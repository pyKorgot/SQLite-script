#SQL-Script

Программа для создания Базы Данных, получения PDF и XLSX информации, а так же возможности внесения новых данных из файлов того же вида.

        Файлы
1. Media (папка) - содержит файлы создаваемые или требуемые для работы программы, не имеющие прямого отношения к коду.
    1.1. resume_import.xlsx - пример для ввода новых пользователей их EXCEL.
    1.2. resume_import.pdf - пример для ввода новых пользователей из PDF.
    1.3. Anton.pdf - пример PDF, где нужно было спарсить себя.
    Файлы после работы скрипта:
        1. resume_export.xlsx - вывод пользователей в EXCEL.
        2. resume_export.pdf - вывод пользователей в PDF.
2. create.sql - sql скрипт для создания базы данных проекта, так же содержит скрипты для первичного заполнения.
3. create_db.py - python скрипт для запуска базы данных и создания первичных таблиц, использует create.sql.
4. xlsx_import.py - python скрипт для импорта данных из excel таблицы в бд, каждая новая строка содержит нового пользователя, если id нового пользователя не является уникальным, он пропускается.
5. xlsx_export.py - python скрипт для экспорта данных в excel таблицу из бд, каждая новая строка содержит нового пользователя.
6. pdf_import.py - python скрипт для импорта данных из PDF файла в бд, каждая новая страница, создает отдельного нового пользователя в бд.
7. pdf_export.py - python скрипт для экспорта данных в PDF файл из бд, каждая новая страница, представляет отдельного пользователя.
8. sql_save_select.py - python скрипт необходимый для работы всех остальных скриптов, содержит скрипт обращения и сохранения новых файлов в бд.
9. FreeSans.ttf - шрифт FreeSans необходимый для нормальной работы библиотеки reportlab, необходимой для генерации PDF страниц.
10. requirements.txt - текстовый файл для установки всех необходимых библиотек.
11. README.md - файл к прочтению.

        Библиотеки
1. sqlite3 - классическая библиотека для работы с sqlite3
2. openpyxl - библиотека для работы с xlsx.
3. PyMuPDF - библиотека для чтения из PDF.
4. reportlab - библиотека для создания PDF файлов.


        Инструкция

    Развертывание среды
1. Создание
$ python3 -m venv venv
2. Запуск
$ source venv/bin/activate
3. Установка библиотек
$ pip install -r requirements.txt

    Создание базы данных
1. Способ первый
$ python3 create_db.py
Создает базу данных и заполняет первичные данные.
2. Способ второй
$ sqlite3
sqlite> .read create.sql

    Экспорт и Импорт из XLSX
1. $ python xlsx_export.py
Создает в папке media файл resume_import.xlsx, из данных бд.
Импорт в xlsx
2. $ python xlsx_import.py
Из папки media берет файл resume_export.xlsx и сохраняет данные, в бд.

    Экспорт и Импорт из PDF
1. $ python pdf_import.py
Из папки media берет файл resume_import и заносит его данные в бд, каждая страница в PDF сохраняет различных людей.
2. $ python pdf_export.py
Создает в папке media файл resume_export.pdf, где каждая страница содержит отдельного человека из бд.